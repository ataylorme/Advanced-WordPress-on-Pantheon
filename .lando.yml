name: pantheon-wp-best-practices

recipe: pantheon

config:
  framework: wordpress
  site: pantheon-wp-best-practices
  id: 094f4627-a25e-4d60-8d5b-a3d99a7232bf
  xdebug: true
  webroot: web
  php: '7.2'

services:
  # Use a custom appserver with headless Chrome
  appserver:
    type: php:custom
    overrides:
      image: ataylorme/docker-php-advanced-wordpress-on-pantheon:headless-chrome-lando
      ports:
        # Expose port 9222 for headless Chrome
        - "9222:9222"

# Additional "lando" commands
tooling:
  composer:
    service: appserver
  wp:
    service: appserver
  composer-install:
    description: Install Composer dependencies
    cmd: ./bin/install-composer-dependencies.sh
    service: appserver
  code-sniff:
    description: Run Code Sniffing
    cmd: ./vendor/bin/phpcs --extensions=php --runtime-set ignore_warnings_on_exit true ./web/wp-content/themes/twentyseventeen-child/* ./tests/*
    service: appserver
  code-sniff-fix:
    description: Fix Code Sniffing
    cmd: ./vendor/bin/phpcbf --ignore=*/.git*/*,*/node_modules/* --extensions=php ./web/wp-content/themes/twentyseventeen-child/* ./tests/*
    service: appserver
  unit-test:
    description: Run unit tests
    cmd: composer -n unit-test
    service: appserver
  wordhat:
    description: Run WordHat
    cmd: ./bin/local-behat-headless-chrome.sh
    service: appserver
  restore-db:
    description: Restore the database
    cmd: ./bin/restore-db.sh
    service: appserver
  export-db:
    description: export the database
    cmd: ./bin/export-db.sh
    service: appserver
  wordhat-commands:
    description: List WordHat commands
    cmd: composer -n wordhat-scenarios
    service: appserver